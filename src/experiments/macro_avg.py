import pandas as pd

# Load the results generated by the script
df = pd.read_parquet("./data/results/llm_query_eval_scores.parquet")

# Calculate Macro-Averages
metrics = [
    'precision', 'recall', 'f1', 'f3', 'map', 
    'p@1', 'r@1', 'p@5', 'r@5', 'p@10', 'r@10', 
    'p@20', 'r@20', 'p@50', 'r@50', 'p@100', 'r@100', 'p@1000', 'r@1000'
]
mean_values = df[metrics].mean()

# Optional: Format nicely for the paper (e.g., 3 decimal places)
print(mean_values.round(3))

# Save the macro-average results to a file
mean_values.to_csv("./data/results/llm_boolean_macro_avg_scores.csv", header=['macro_average'])